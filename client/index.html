<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Dungeon Crawler</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#1a1a2e;touch-action:none;user-select:none;-webkit-user-select:none;font-family:'Segoe UI',system-ui,sans-serif}
canvas{display:block;width:100%;height:100%}
#ui-overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}
#health-bar-container{position:absolute;top:env(safe-area-inset-top,12px);left:50%;transform:translateX(-50%);width:55%;max-width:260px;pointer-events:none}
#level-label{color:#fbbf24;font-size:12px;font-weight:800;text-shadow:0 1px 3px rgba(0,0,0,0.8);text-align:center;margin-bottom:2px}
#health-bar-bg{width:100%;height:20px;background:rgba(0,0,0,0.6);border-radius:0;border:2px solid rgba(0,255,255,0.4);overflow:hidden;position:relative}
#health-bar-fill{height:100%;background:linear-gradient(180deg,#00ff88,#00cc66);border-radius:0;transition:width 0.3s;width:100%}
#health-text{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:10px;font-weight:700;text-shadow:0 1px 2px rgba(0,0,0,0.8)}
#xp-bar-bg{width:100%;height:8px;background:rgba(0,0,0,0.5);border-radius:0;overflow:hidden;margin-top:3px}
#xp-bar-fill{height:100%;background:linear-gradient(180deg,#00aaff,#0088cc);border-radius:0;transition:width 0.3s;width:0%}
#gold-display{position:absolute;top:env(safe-area-inset-top,12px);left:12px;color:#fbbf24;font-size:14px;font-weight:700;text-shadow:0 1px 4px rgba(0,0,0,0.8);pointer-events:none;margin-top:32px}
#bag-btn{position:absolute;top:env(safe-area-inset-top,12px);left:12px;width:40px;height:40px;background:rgba(0,0,0,0.5);border:2px solid rgba(255,255,255,0.3);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;pointer-events:auto;cursor:pointer;-webkit-tap-highlight-color:transparent}
#stats-btn{position:absolute;top:env(safe-area-inset-top,12px);left:58px;width:40px;height:40px;background:rgba(0,0,0,0.5);border:2px solid rgba(255,255,255,0.3);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;pointer-events:auto;cursor:pointer;-webkit-tap-highlight-color:transparent}
#depth-display{position:absolute;top:env(safe-area-inset-top,12px);right:100px;color:#94a3b8;font-size:11px;font-weight:600;text-shadow:0 1px 3px rgba(0,0,0,0.8);pointer-events:none}
#minimap{position:absolute;top:env(safe-area-inset-top,12px);right:12px;pointer-events:none;width:80px;height:80px}
#room-label{position:absolute;top:calc(env(safe-area-inset-top,12px) + 30px);left:50%;transform:translateX(-50%);color:#fff;font-size:13px;font-weight:600;text-shadow:0 1px 4px rgba(0,0,0,0.8);pointer-events:none;opacity:0;transition:opacity 0.5s}
#pickup-notifications{position:absolute;top:calc(env(safe-area-inset-top,12px) + 70px);left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:4px;pointer-events:none}
.pickup-note{color:#fff;font-size:13px;font-weight:700;text-shadow:0 1px 4px rgba(0,0,0,0.8);animation:pickupAnim 1.5s forwards;white-space:nowrap}
@keyframes pickupAnim{0%{opacity:1;transform:translateY(0)}70%{opacity:1}100%{opacity:0;transform:translateY(-20px)}}
#joystick-zone{position:absolute;bottom:20px;left:20px;width:140px;height:140px;pointer-events:auto}
#joystick-base{width:120px;height:120px;background:rgba(255,255,255,0.12);border:2px solid rgba(255,255,255,0.2);border-radius:50%;position:absolute;bottom:10px;left:10px}
#joystick-thumb{width:50px;height:50px;background:rgba(255,255,255,0.35);border:2px solid rgba(255,255,255,0.5);border-radius:50%;position:absolute;bottom:45px;left:45px;transition:none}
#ability-zone{position:absolute;bottom:30px;right:20px;display:flex;gap:14px;pointer-events:auto}
.ability-btn{width:64px;height:64px;border-radius:50%;border:3px solid rgba(255,255,255,0.4);display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff;font-weight:700;position:relative;overflow:hidden;cursor:pointer;-webkit-tap-highlight-color:transparent}
.ability-btn .cd-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);clip-path:polygon(50% 50%,50% 0%,50% 0%);pointer-events:none}
.ability-btn .cd-text{position:absolute;font-size:16px;font-weight:800;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,0.8)}
#btn-attack{background:radial-gradient(circle,#ef4444,#b91c1c)}
#btn-dash{background:radial-gradient(circle,#3b82f6,#1d4ed8)}
#btn-ability1{background:radial-gradient(circle,#a855f7,#7c3aed);display:none}
#btn-ability2{background:radial-gradient(circle,#14b8a6,#0d9488);display:none}
#btn-ability1.tank{background:radial-gradient(circle,#3b82f6,#1e40af)}
#btn-ability2.tank{background:radial-gradient(circle,#60a5fa,#2563eb)}
#btn-ability1.healer{background:radial-gradient(circle,#22c55e,#16a34a)}
#btn-ability2.healer{background:radial-gradient(circle,#4ade80,#22c55e)}
#btn-ability1.dps{background:radial-gradient(circle,#ef4444,#dc2626)}
#btn-ability2.dps{background:radial-gradient(circle,#f97316,#ea580c)}
#screen-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;flex-direction:column;background:rgba(0,0,0,0.85);z-index:100;pointer-events:auto}
#screen-overlay h1{color:#fbbf24;font-size:32px;text-shadow:0 2px 8px rgba(251,191,36,0.5);margin-bottom:8px}
#screen-overlay p{color:#e2e8f0;font-size:16px;margin-bottom:24px}
#screen-overlay button{padding:14px 40px;font-size:18px;font-weight:700;border:none;border-radius:12px;background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#1a1a2e;cursor:pointer;box-shadow:0 4px 12px rgba(251,191,36,0.4)}
#start-screen{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;background:linear-gradient(180deg,#1a1a2e,#16213e);z-index:200;pointer-events:auto}
#start-screen h1{color:#fbbf24;font-size:36px;text-shadow:0 2px 12px rgba(251,191,36,0.5);margin-bottom:6px;letter-spacing:2px}
#start-screen p{color:#94a3b8;font-size:14px;margin-bottom:30px}
#start-screen button{padding:16px 48px;font-size:20px;font-weight:800;border:none;border-radius:14px;background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#1a1a2e;cursor:pointer;box-shadow:0 4px 16px rgba(251,191,36,0.4);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
#death-screen{position:absolute;top:0;left:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;flex-direction:column;background:rgba(127,29,29,0.85);z-index:100;pointer-events:auto}
#death-screen h1{color:#fca5a5;font-size:32px;margin-bottom:8px}
#death-screen p{color:#e2e8f0;font-size:16px;margin-bottom:24px}
#death-screen button{padding:14px 40px;font-size:18px;font-weight:700;border:none;border-radius:12px;background:linear-gradient(180deg,#ef4444,#dc2626);color:#fff;cursor:pointer}

/* Hub screen */
#hub-screen{position:absolute;top:0;left:0;width:100%;height:100%;display:none;flex-direction:column;align-items:center;justify-content:flex-start;background:linear-gradient(180deg,#1a1a2e,#16213e);z-index:150;pointer-events:auto;overflow-y:auto;padding:40px 20px 40px}
#hub-screen .hub-title{color:#94a3b8;font-size:12px;text-transform:uppercase;letter-spacing:3px;margin-bottom:8px}
#hub-hero-name{color:#fbbf24;font-size:28px;font-weight:800;text-shadow:0 2px 8px rgba(251,191,36,0.5);margin-bottom:2px}
#hub-hero-level{color:#a78bfa;font-size:14px;margin-bottom:16px}
#hub-character-canvas{width:160px;height:160px;border-radius:50%;margin-bottom:16px}
#hub-stats-row{display:flex;gap:16px;margin-bottom:12px}
.hub-stat-box{background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:10px;padding:8px 14px;text-align:center;min-width:70px}
.hub-stat-box .stat-val{color:#fbbf24;font-size:18px;font-weight:800}
.hub-stat-box .stat-label{color:#94a3b8;font-size:10px;text-transform:uppercase;letter-spacing:1px}
#hub-info{color:#94a3b8;font-size:13px;text-align:center;margin-bottom:16px;line-height:1.8}
#hub-info span{color:#fbbf24}
#hub-gear-slots{display:flex;gap:10px;margin-bottom:20px}
.hub-gear-slot{width:64px;height:64px;background:rgba(255,255,255,0.06);border:2px solid rgba(255,255,255,0.15);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:10px;color:#94a3b8;text-align:center}
.hub-gear-slot .item-icon{font-size:24px;margin-bottom:2px}
.hub-gear-slot .item-name{font-size:8px;line-height:1.1;color:#fff}
#hub-buttons{display:flex;flex-direction:column;gap:10px;width:100%;max-width:280px;align-items:center}
#hub-buttons button{width:100%;padding:14px;font-size:18px;font-weight:800;border:none;border-radius:14px;cursor:pointer;box-shadow:0 4px 16px rgba(0,0,0,0.3)}
#btn-enter-dungeon{background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#1a1a2e;animation:pulse 2s infinite}
#btn-hub-inventory{background:rgba(255,255,255,0.1);color:#e2e8f0;border:2px solid rgba(255,255,255,0.2)!important;font-size:15px!important}

/* Stats panel */
#stats-panel{position:absolute;top:0;left:0;width:100%;height:100%;display:none;flex-direction:column;align-items:center;background:rgba(0,0,0,0.94);z-index:180;pointer-events:auto;overflow-y:auto;padding:50px 20px 30px}
#stats-panel h2{color:#fbbf24;font-size:22px;margin-bottom:16px}
#stats-close{position:absolute;top:16px;right:16px;color:#fff;font-size:28px;cursor:pointer;width:40px;height:40px;display:flex;align-items:center;justify-content:center}
.stats-section{width:100%;max-width:340px;margin-bottom:18px}
.stats-section h3{color:#94a3b8;font-size:11px;text-transform:uppercase;margin-bottom:8px;letter-spacing:1px;border-bottom:1px solid rgba(255,255,255,0.08);padding-bottom:4px}
.stat-row{display:flex;justify-content:space-between;padding:5px 0;color:#e2e8f0;font-size:14px}
.stat-row .stat-name{color:#94a3b8}
.stat-row .stat-value{color:#fff;font-weight:700}
.stat-row .stat-bonus{color:#22c55e;font-size:12px;margin-left:4px}
.stat-row .stat-base{color:#94a3b8;font-size:12px}

/* Inventory panel */
#inventory-panel{position:absolute;top:0;left:0;width:100%;height:100%;display:none;flex-direction:column;align-items:center;background:rgba(0,0,0,0.92);z-index:180;pointer-events:auto;overflow-y:auto;padding:50px 16px 30px}
#inventory-panel h2{color:#fbbf24;font-size:22px;margin-bottom:12px}
#inv-close{position:absolute;top:16px;right:16px;color:#fff;font-size:28px;cursor:pointer;width:40px;height:40px;display:flex;align-items:center;justify-content:center}
.inv-section{width:100%;max-width:360px;margin-bottom:16px}
.inv-section h3{color:#94a3b8;font-size:12px;text-transform:uppercase;margin-bottom:6px;letter-spacing:1px}
.inv-slots{display:flex;flex-wrap:wrap;gap:8px}
.inv-slot{width:72px;height:72px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.15);border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:10px;color:#fff;cursor:pointer;position:relative;text-align:center;padding:2px}
.inv-slot.empty{opacity:0.4}
.inv-slot .item-icon{font-size:22px;margin-bottom:2px}
.inv-slot .item-name{font-size:8px;line-height:1.1}
.rarity-common{border-color:rgba(255,255,255,0.4)}
.rarity-uncommon{border-color:#22c55e}
.rarity-rare{border-color:#3b82f6}
.rarity-epic{border-color:#a855f7}
.rarity-legendary{border-color:#f97316;animation:legendaryPulse 2s infinite}
@keyframes legendaryPulse{0%,100%{box-shadow:0 0 6px #f97316}50%{box-shadow:0 0 16px #f97316,0 0 24px rgba(249,115,22,0.4)}}
.inv-slot .new-badge{position:absolute;top:-4px;right:-4px;background:#ef4444;color:#fff;font-size:8px;font-weight:800;padding:1px 4px;border-radius:6px;z-index:2}
.inv-slot .card-indicator{position:absolute;bottom:2px;right:2px;font-size:10px}
.inv-sort-bar{display:flex;gap:6px;margin-bottom:8px;width:100%;max-width:360px}
.inv-sort-bar button{padding:4px 10px;font-size:11px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.08);color:#94a3b8;border-radius:6px;cursor:pointer}
.inv-sort-bar button.active{background:rgba(251,191,36,0.2);border-color:#fbbf24;color:#fbbf24}

/* Item tooltip */
#item-tooltip{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:280px;max-width:90vw;background:rgba(15,15,30,0.97);border:2px solid #fbbf24;border-radius:14px;padding:16px;z-index:300;pointer-events:auto;display:none;font-size:13px;color:#e2e8f0;box-shadow:0 0 30px rgba(0,0,0,0.8)}
#item-tooltip .tt-name{font-size:16px;font-weight:800;margin-bottom:2px}
#item-tooltip .tt-rarity{font-size:11px;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
#item-tooltip .tt-ilvl{font-size:10px;color:#94a3b8;margin-bottom:8px}
#item-tooltip .tt-stats{margin-bottom:8px}
#item-tooltip .tt-stat{padding:2px 0}
#item-tooltip .tt-stat.positive{color:#22c55e}
#item-tooltip .tt-stat.negative{color:#ef4444}
#item-tooltip .tt-affixes{border-top:1px solid rgba(255,255,255,0.1);padding-top:6px;margin-bottom:6px}
#item-tooltip .tt-affix{color:#a78bfa;font-size:12px;padding:1px 0}
#item-tooltip .tt-passive{color:#f97316;font-size:12px;font-style:italic;border-top:1px solid rgba(255,255,255,0.1);padding-top:6px;margin-bottom:6px}
#item-tooltip .tt-card{border-top:1px solid rgba(255,255,255,0.1);padding-top:6px;margin-bottom:6px;font-size:12px}
#item-tooltip .tt-card.empty{color:#94a3b8}
#item-tooltip .tt-compare{border-top:1px solid rgba(255,255,255,0.1);padding-top:6px;font-size:11px;color:#94a3b8}
#item-tooltip .tt-compare .better{color:#22c55e}
#item-tooltip .tt-compare .worse{color:#ef4444}
#item-tooltip .tt-actions{display:flex;gap:8px;margin-top:10px;justify-content:center}
#item-tooltip .tt-actions button{padding:8px 16px;font-size:13px;font-weight:700;border:none;border-radius:8px;cursor:pointer}
#item-tooltip .tt-btn-equip{background:#22c55e;color:#fff}
#item-tooltip .tt-btn-unequip{background:#3b82f6;color:#fff}
#item-tooltip .tt-btn-card{background:#a855f7;color:#fff}
#item-tooltip .tt-btn-discard{background:#ef4444;color:#fff}
#item-tooltip .tt-btn-close{background:rgba(255,255,255,0.15);color:#fff}

/* Loot drop visuals */
.loot-pillar{position:absolute;pointer-events:none;z-index:50}
@keyframes legendaryFlash{0%{opacity:1}100%{opacity:0}}
#legendary-flash{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(249,115,22,0.5);pointer-events:none;z-index:80;display:none;animation:legendaryFlash 0.5s forwards}

/* Card slot modal */
#card-slot-modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:260px;background:rgba(15,15,30,0.97);border:2px solid #a855f7;border-radius:14px;padding:16px;z-index:310;display:none;color:#e2e8f0;font-size:13px}
#card-slot-modal h3{color:#a855f7;font-size:15px;margin-bottom:10px;text-align:center}
#card-slot-modal .card-list{display:flex;flex-direction:column;gap:6px}
#card-slot-modal .card-option{display:flex;align-items:center;gap:8px;padding:8px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:8px;cursor:pointer}
#card-slot-modal .card-option:active{background:rgba(168,85,247,0.2)}
#card-slot-modal button{margin-top:10px;width:100%;padding:8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff;font-size:13px;cursor:pointer}

/* Level up overlay */
#levelup-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;flex-direction:column;z-index:90;pointer-events:none}
#levelup-flash{position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle,rgba(251,191,36,0.6),rgba(251,191,36,0));opacity:0;transition:opacity 0.2s}
#levelup-text{color:#fbbf24;font-size:48px;font-weight:900;text-shadow:0 0 30px rgba(251,191,36,0.8),0 0 60px rgba(251,191,36,0.4);opacity:0;transform:scale(0.3);letter-spacing:4px}
#levelup-stats{color:#e2e8f0;font-size:16px;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,0.8);opacity:0;margin-top:12px;text-align:center;line-height:1.8}
@keyframes levelupScale{0%{transform:scale(0.3);opacity:0}20%{transform:scale(1.3);opacity:1}40%{transform:scale(1);opacity:1}80%{transform:scale(1);opacity:1}100%{transform:scale(1.1);opacity:0}}
@keyframes levelupStatsFade{0%{opacity:0;transform:translateY(20px)}20%{opacity:1;transform:translateY(0)}80%{opacity:1}100%{opacity:0}}

/* Emote wheel */
#emote-wheel{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:200px;height:200px;pointer-events:auto;z-index:250}
.emote-option{position:absolute;width:50px;height:50px;background:rgba(0,0,0,0.85);border:2px solid rgba(255,255,255,0.3);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;transition:transform 0.15s,border-color 0.15s;-webkit-tap-highlight-color:transparent}
.emote-option:hover,.emote-option:active{transform:scale(1.2);border-color:#fbbf24}
.emote-option:nth-child(1){top:0;left:50%;transform:translateX(-50%)}
.emote-option:nth-child(2){top:15%;right:8%}
.emote-option:nth-child(3){top:50%;right:0;transform:translateY(-50%)}
.emote-option:nth-child(4){bottom:15%;right:8%}
.emote-option:nth-child(5){bottom:0;left:50%;transform:translateX(-50%)}
.emote-option:nth-child(6){bottom:15%;left:8%}
.emote-option:nth-child(7){top:50%;left:0;transform:translateY(-50%)}
.emote-option:nth-child(8){top:15%;left:8%}
#emote-wheel::before{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;background:rgba(0,0,0,0.6);border:2px solid rgba(255,255,255,0.2);border-radius:50%;z-index:-1}

/* Chat input overlay */
#chat-input-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:260;pointer-events:auto}
#chat-input{width:280px;max-width:80%;padding:14px 18px;font-size:16px;font-family:inherit;background:rgba(20,20,40,0.95);border:2px solid #fbbf24;border-radius:12px;color:#fff;outline:none}
#chat-input::placeholder{color:#94a3b8}

/* Emote button style (smaller than attack/dash) */
#btn-emote{background:radial-gradient(circle,#6366f1,#4f46e5);width:52px;height:52px}

/* Hub Mode Navigation */
.hub-mode-nav{display:flex;gap:10px;margin-bottom:16px;width:100%;max-width:320px}
.mode-btn{flex:1;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.15);border-radius:12px;padding:12px 8px;display:flex;flex-direction:column;align-items:center;cursor:pointer;transition:all 0.2s}
.mode-btn:active{transform:scale(0.98);background:rgba(255,255,255,0.12)}
.mode-btn .mode-icon{font-size:24px;margin-bottom:4px}
.mode-btn .mode-label{color:#fff;font-size:12px;font-weight:700}
.mode-btn .mode-desc{color:#94a3b8;font-size:9px}
.mode-btn.open-world-btn{border-color:#22c55e50}
.mode-btn.open-world-btn:active{border-color:#22c55e;background:rgba(34,197,94,0.15)}
.mode-btn.dungeon-btn{border-color:#fbbf2450}
.mode-btn.dungeon-btn:active{border-color:#fbbf24;background:rgba(251,191,36,0.15)}
.mode-btn.raid-btn{border-color:#ef444450}
.mode-btn.raid-btn:active{border-color:#ef4444;background:rgba(239,68,68,0.15)}

/* Mode Overlay (shared) */
.mode-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;align-items:center;justify-content:center;z-index:200;pointer-events:auto}
.mode-panel{background:rgba(20,20,40,0.95);border:2px solid rgba(255,255,255,0.2);border-radius:16px;padding:24px;max-width:320px;width:90%;color:#e2e8f0}
.mode-panel h2{color:#fbbf24;font-size:20px;text-align:center;margin-bottom:16px}
.mode-panel p{color:#94a3b8;font-size:13px;text-align:center;margin-bottom:16px;line-height:1.5}
.mode-panel .mode-info{background:rgba(255,255,255,0.05);border-radius:10px;padding:12px;margin-bottom:16px}
.mode-panel .info-row{display:flex;justify-content:space-between;padding:4px 0;font-size:12px}
.mode-panel .info-row span{color:#94a3b8}
.mode-buttons{display:flex;flex-direction:column;gap:10px}
.mode-buttons button{padding:12px;font-size:14px;font-weight:700;border:none;border-radius:10px;cursor:pointer}
.mode-buttons .btn-enter,.mode-buttons .btn-solo,.mode-buttons .btn-queue{background:linear-gradient(180deg,#22c55e,#16a34a);color:#fff}
.mode-buttons .btn-coop{background:linear-gradient(180deg,#3b82f6,#2563eb);color:#fff}
.mode-buttons .btn-cancel{background:rgba(255,255,255,0.1);color:#94a3b8;border:1px solid rgba(255,255,255,0.2)}

/* Dungeon Board */
.dungeon-panel .tier-select{margin-bottom:16px}
.dungeon-panel .tier-select h3{color:#94a3b8;font-size:11px;text-transform:uppercase;margin-bottom:8px}
.tier-option{display:flex;align-items:center;gap:12px;background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.1);border-radius:10px;padding:10px;margin-bottom:8px;cursor:pointer;transition:all 0.2s}
.tier-option:active,.tier-option.selected{border-color:#fbbf24;background:rgba(251,191,36,0.1)}
.tier-option .tier-icon{font-size:24px}
.tier-option .tier-info{display:flex;flex-direction:column}
.tier-option .tier-name{color:#fff;font-size:14px;font-weight:600}
.tier-option .tier-levels{color:#94a3b8;font-size:11px}
.difficulty-select{margin-bottom:16px}
.difficulty-select h3{color:#94a3b8;font-size:11px;text-transform:uppercase;margin-bottom:8px}
.star-rating{display:flex;gap:8px;justify-content:center;margin-bottom:8px}
.star-rating .star{font-size:28px;color:rgba(255,255,255,0.2);cursor:pointer;transition:all 0.15s}
.star-rating .star.active{color:#fbbf24;text-shadow:0 0 10px rgba(251,191,36,0.5)}
.difficulty-bonus{display:block;text-align:center;color:#94a3b8;font-size:11px}

/* Raid Gate */
.raid-panel .raid-comp{margin-bottom:16px}
.raid-panel .raid-comp h3{color:#94a3b8;font-size:11px;text-transform:uppercase;margin-bottom:8px}
.role-slots{display:flex;gap:8px;justify-content:center}
.role-slot{background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.1);border-radius:8px;padding:8px 12px;text-align:center;font-size:11px;color:#94a3b8}
.role-slot span{font-size:18px;display:block;margin-bottom:2px}
.role-slot.tank{border-color:#3b82f680}
.role-slot.healer{border-color:#22c55e80}
.role-slot.dps{border-color:#ef444480}
.your-role{text-align:center;font-size:14px;margin-bottom:12px}
.your-role strong{color:#fbbf24}
.raid-rewards{background:rgba(255,255,255,0.05);border-radius:10px;padding:10px;margin-bottom:16px}
.raid-rewards .reward{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:12px;color:#94a3b8}
.raid-rewards .reward span{font-size:16px}

/* Queue Status Overlay */
.queue-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;align-items:center;justify-content:center;z-index:210;pointer-events:auto}
.queue-panel{text-align:center;color:#e2e8f0;padding:32px}
.queue-spinner{width:60px;height:60px;border:4px solid rgba(255,255,255,0.1);border-top-color:#fbbf24;border-radius:50%;margin:0 auto 20px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.queue-panel h3{font-size:18px;margin-bottom:8px}
.queue-time{font-size:32px;font-weight:700;color:#fbbf24;margin-bottom:8px}
.queue-type{color:#94a3b8;font-size:13px;margin-bottom:20px}
.btn-cancel-queue{padding:12px 32px;font-size:14px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:10px;color:#fff;cursor:pointer}
.btn-start-solo{padding:12px 32px;font-size:14px;background:linear-gradient(180deg,#22c55e,#16a34a);border:none;border-radius:10px;color:#fff;cursor:pointer;margin-bottom:10px}

/* Return to Hub button (shown in game) */
#btn-return-hub{position:absolute;top:env(safe-area-inset-top,12px);right:100px;width:36px;height:36px;background:rgba(0,0,0,0.5);border:2px solid rgba(255,255,255,0.3);border-radius:8px;display:none;align-items:center;justify-content:center;font-size:18px;pointer-events:auto;cursor:pointer}

/* Open World room indicator */
#ow-room-indicator{position:absolute;top:calc(env(safe-area-inset-top,12px) + 52px);left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.2);border-radius:8px;padding:4px 12px;color:#94a3b8;font-size:11px;pointer-events:none;display:none}
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="ui-overlay">
  <div id="health-bar-container">
    <div id="level-label">Lv 1</div>
    <div id="health-bar-bg"><div id="health-bar-fill"></div><div id="health-text">100 / 100</div></div>
    <div id="xp-bar-bg"><div id="xp-bar-fill"></div></div>
  </div>
  <div id="bag-btn">üéí</div>
  <div id="stats-btn">üìä</div>
  <div id="gold-display">üí∞ 0</div>
  <div id="depth-display"></div>
  <div id="btn-return-hub">üè†</div>
  <div id="ow-room-indicator">Room (5, 5)</div>
  <canvas id="minimap" width="80" height="80"></canvas>
  <div id="room-label"></div>
  <div id="pickup-notifications"></div>
  <div id="levelup-overlay">
    <div id="levelup-flash"></div>
    <div id="levelup-text">LEVEL UP!</div>
    <div id="levelup-stats"></div>
  </div>
  <div id="joystick-zone"><div id="joystick-base"></div><div id="joystick-thumb"></div></div>
  <div id="ability-zone">
    <div class="ability-btn" id="btn-emote"><span>üí¨</span></div>
    <div class="ability-btn" id="btn-ability1"><span>Q</span><div class="cd-overlay"></div><span class="cd-text"></span></div>
    <div class="ability-btn" id="btn-ability2"><span>E</span><div class="cd-overlay"></div><span class="cd-text"></span></div>
    <div class="ability-btn" id="btn-attack"><span>‚öî</span><div class="cd-overlay"></div><span class="cd-text"></span></div>
    <div class="ability-btn" id="btn-dash"><span>üí®</span><div class="cd-overlay"></div><span class="cd-text"></span></div>
  </div>
</div>
<div id="start-screen"><h1>‚öî DUNGEON CRAWLER</h1><p>Casual Dungeon Crawling</p><button id="btn-start">TAP TO PLAY</button></div>
<div id="screen-overlay"><h1>üèÜ DUNGEON COMPLETE!</h1><p id="complete-text">You conquered the dungeon!</p><button id="btn-restart">RETURN TO HUB</button></div>
<div id="death-screen"><h1>üíÄ YOU DIED</h1><p>The dungeon claims another soul...</p><button id="btn-retry">RETURN TO HUB</button></div>
<div id="hub-screen">
  <div class="hub-title">ADVENTURER'S HUB</div>
  <canvas id="hub-character-canvas" width="160" height="160"></canvas>
  <div id="hub-hero-name">Hero</div>
  <div id="hub-hero-level">Level 1</div>
  <div id="hub-stats-row">
    <div class="hub-stat-box"><div class="stat-val" id="hub-atk">25</div><div class="stat-label">ATK</div></div>
    <div class="hub-stat-box"><div class="stat-val" id="hub-def">0</div><div class="stat-label">DEF</div></div>
    <div class="hub-stat-box"><div class="stat-val" id="hub-hp">100</div><div class="stat-label">HP</div></div>
  </div>
  <div id="hub-info"></div>
  <div id="hub-gear-slots"></div>
  <div id="hub-buttons">
    <button id="btn-enter-dungeon">‚öî ENTER DUNGEON</button>
    <button id="btn-hub-inventory">üéí INVENTORY</button>
  </div>
</div>
<div id="inventory-panel">
  <div id="inv-close">‚úï</div>
  <h2>üéí Inventory</h2>
  <div class="inv-section"><h3>Equipped</h3><div class="inv-slots" id="equipped-slots"></div></div>
  <div class="inv-section"><h3>Backpack</h3><div class="inv-slots" id="backpack-slots"></div></div>
</div>
<div id="item-tooltip"></div>
<div id="card-slot-modal"><h3>üÉè Slot a Card</h3><div class="card-list" id="card-list"></div><button id="card-modal-close">Cancel</button></div>
<div id="legendary-flash"></div>
<div id="stats-panel">
  <div id="stats-close">‚úï</div>
  <h2>üìä Stats</h2>
  <div id="stats-content"></div>
</div>

<!-- Emote Wheel Overlay -->
<div id="emote-wheel" style="display:none">
  <div class="emote-option" data-emote="Help!">üÜò</div>
  <div class="emote-option" data-emote="üëç">üëç</div>
  <div class="emote-option" data-emote="Thanks!">üôè</div>
  <div class="emote-option" data-emote="‚ù§Ô∏è">‚ù§Ô∏è</div>
  <div class="emote-option" data-emote="Go!">üèÉ</div>
  <div class="emote-option" data-emote="üëé">üëé</div>
  <div class="emote-option" data-emote="Here!">üìç</div>
  <div class="emote-option" data-emote="‚ùì">‚ùì</div>
</div>

<!-- Chat Input Overlay -->
<div id="chat-input-overlay" style="display:none">
  <input type="text" id="chat-input" placeholder="Type a message..." maxlength="100" autocomplete="off">
</div>

<div id="connection-status" style="position:absolute;top:6px;right:6px;width:10px;height:10px;border-radius:50%;background:#ef4444;z-index:999;pointer-events:none;opacity:0.8"></div>

<!-- Reconnecting Overlay -->
<div id="reconnecting-overlay" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(10,10,18,0.95);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:9999;pointer-events:auto">
  <div style="width:50px;height:50px;border:4px solid rgba(255,255,255,0.1);border-top-color:#fbbf24;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px"></div>
  <h2 style="color:#fbbf24;font-size:24px;margin-bottom:10px;text-shadow:0 0 20px rgba(251,191,36,0.5)">Reconnecting...</h2>
  <p style="color:#94a3b8;font-size:14px">Please wait while we restore your connection</p>
</div>

<!-- Connection Failed Overlay -->
<div id="connection-failed-overlay" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(127,29,29,0.95);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:9999;pointer-events:auto">
  <h2 style="color:#fca5a5;font-size:28px;margin-bottom:10px">Connection Failed</h2>
  <p style="color:#e2e8f0;font-size:14px;margin-bottom:20px;text-align:center">Unable to connect to the game server.<br>Please check your connection and try again.</p>
  <button onclick="location.reload()" style="padding:14px 40px;font-size:18px;font-weight:700;border:none;border-radius:12px;background:linear-gradient(180deg,#ef4444,#dc2626);color:#fff;cursor:pointer">Retry Connection</button>
</div>

<script type="module" src="/src/main.ts"></script>
</body>
</html>
